TEST COMPLETO (post arreglo)
🆗= todo OK
❓= no sé qué significa / está en notas
✖️= algo mal / no existe


1.- ERRORES (de testing 6)
1.- No error propio de este apartado, pero me aparecen estos 3 errores por ahora
GET
http://localhost:3001/favicon.ico
[HTTP/1.1 404 Not Found 3ms]


XHRGET
http://localhost:3001/api/wishlist
[HTTP/1.1 500 Internal Server Error 430ms]


XHRGET
http://localhost:3001/api/wishlist
[HTTP/1.1 500 Internal Server Error 456ms]




1.- NOTAS (de testing 6)
1.- En validación de login, si bien no te deja iniciar sesión con los campos vacíos, en realidad no marca como error o sea no te dice un mensaje que dice que email o contraseña requerido, simplemente te lo marca con un borde en rojo y redirige tipo a que como si hubieses clickeado en email para escribir en el campo. Supongo que es funcional verdad? Aunque sería mejor con mensajes? Decidir.


2.- Probé con adasdad@gmail.cum registrando y por alguna razón si lo validó, cuando no creo que exista el .cum verdad? 


## 6. TESTING DE AUTENTICACIÓN


### 6.1 Página de Login


**URL de prueba:** `http://localhost:3000/login` o click en "Cuenta" > "Iniciar sesión"


- [🆗 ] **Carga de Página**
  - [🆗 ] Página carga sin errores
  - [🆗 ] Formulario de login visible
  - [🆗 ] Logo de Vialine visible


- [🆗 ] **Formulario de Login**
  - [ 🆗] Campo "Email" visible
  - [🆗 ] Campo "Contraseña" visible
  - [✖️ ] Checkbox "Recordarme" (opcional)
  - [✖️] Link "¿Olvidaste tu contraseña?"
  - [🆗 ] Botón "Iniciar sesión"
  - [✖️ ] Link "¿No tienes cuenta? Regístrate"


### 6.2 Validaciones de Login


- [🆗 ] **Campos Vacíos**
  - [🆗] Dejar ambos campos vacíos
  - [🆗 ] Click en "Iniciar sesión"
  - [❓ ] Error: "El email es requerido"
  - [❓ ] Error: "La contraseña es requerida"


- [ 🆗] **Email Inválido**
  - [ 🆗] Escribir: `test@invalid`
  - [🆗 ] Error: "Email inválido"


- [ 🆗] **Contraseña Incorrecta**
  - [ 🆗] Email: `test@vialine.com`
  - [ 🆗] Contraseña: `WrongPassword123`
  - [🆗 ] Click "Iniciar sesión"
  - [ 🆗] Loading spinner visible
  - [🆗 ] Error: "Email o contraseña incorrectos"


- [ 🆗] **Login Exitoso**
  - [ 🆗] Email: `test@vialine.com`
  - [🆗 ] Contraseña: `TestVialine2025!`
  - [🆗 ] Click "Iniciar sesión"
  - [🆗 ] Loading spinner visible
  - [🆗 ] Redirige a `/account` o homepage
  - [🆗 ] Toast: "Bienvenido, Test User"
  - [ 🆗] Header muestra nombre de usuario en lugar de "Cuenta"


### 6.3 Página de Registro


**URL de prueba:** `http://localhost:3000/register`


- [🆗 ] **Formulario de Registro**
  - [🆗 ] Campo "Nombre"
  - [🆗 ] Campo "Apellido"
  - [🆗] Campo "Email"
  - [🆗 ] Campo "Contraseña"
  - [ 🆗] Campo "Confirmar contraseña"
  - [ ✖️] Checkbox "Acepto términos y condiciones"
  - [🆗 ] Botón "Crear cuenta"
  - [ 🆗] Link "¿Ya tienes cuenta? Inicia sesión"






### 6.4 Validaciones de Registro


- [ 🆗] **Campos Vacíos**
  - [ 🆗] Dejar todos los campos vacíos
  - [🆗 ] Click "Crear cuenta"
  - [🆗 ] Errores en cada campo requerido


- [🆗 ] **Email Ya Registrado**
  - [ 🆗] Email: `test@vialine.com` (ya existe)
  - [ 🆗] Completar otros campos
  - [🆗 ] Click "Crear cuenta"
  - [🆗 ] Error: "Este email ya está registrado"


- [🆗 ] **Contraseñas No Coinciden**
  - [ 🆗] Contraseña: `NewPassword123!`
  - [🆗 ] Confirmar: `DifferentPassword123!`
  - [🆗 ] Error: "Las contraseñas no coinciden"


- [🆗 ] **Contraseña Débil**
  - [🆗 ] Contraseña: `123`
  - [🆗 ] Error: "La contraseña debe tener al menos 8 caracteres"


- [✖️ ] **Términos No Aceptados**
  - [ ✖️] Completar todos los campos correctamente
  - [ ✖️] NO marcar checkbox de términos
  - [✖️ ] Click "Crear cuenta"
  - [ ✖️] Error: "Debes aceptar los términos y condiciones"


### 6.5 Registro Exitoso (SOLO SI QUIERES CREAR CUENTA NUEVA)


**⚠️ OPCIONAL: Esto creará un usuario real en la DB**


- [ ] Nombre: `Test` + nombre random
- [ ] Apellido: `User` + apellido random
- [ ] Email: `test+[timestamp]@vialine.com`
- [ ] Contraseña: `TestVialine2025!`
- [ ] Confirmar contraseña: `TestVialine2025!`
- [ ] Aceptar términos
- [ ] Click "Crear cuenta"
- [ ] Loading spinner
- [ ] Redirige a `/account` o muestra mensaje de verificación de email
- [ ] Toast: "Cuenta creada exitosamente"


### 6.6 OAuth (Google Login)


**⚠️ SOLO SI ESTÁ CONFIGURADO**


- [🆗 ] **Botón "Continuar con Google"**
  - [ 🆗] Botón visible en página de login
  - [🆗 ] Icono de Google visible
  - [✖️ ] Click abre popup de Google
  - [✖️ ] Seleccionar cuenta de Google
  - [✖️ ] Redirige de vuelta a la app
  - [ ✖️] Usuario loggeado correctamente


### 6.7 Recuperación de Contraseña


**URL de prueba:** `http://localhost:3000/forgot-password` o click en "¿Olvidaste tu contraseña?"


- [✖️ ] **Formulario de Recuperación**
  - [✖️ ] Campo "Email" visible
  - [✖️ ] Botón "Enviar link de recuperación"
  - [ ✖️] Link "Volver a iniciar sesión"


- [✖️ ] **Email No Registrado**
  - [✖️ ] Email: `notfound@test.com`
  - [✖️ ] Click "Enviar link"
  - [✖️ ] Error: "Este email no está registrado"


- [✖️ ] **Envío Exitoso**
  - [ ✖️] Email: `test@vialine.com`
  - [ ✖️] Click "Enviar link"
  - [ ✖️] Mensaje: "Hemos enviado un link a tu email"
  - [✖️ ] **VERIFICAR EN CONSOLA:** Log del email enviado (si estás en dev)
  - [ ✖️] **PRODUCCIÓN:** Revisar inbox de Brevo o SendGrid


### 6.8 Sesión Activa


- [ 🆗] **Persistencia de Sesión**
  - [🆗 ] Loggeado como `test@vialine.com`
  - [ 🆗] Refresh de página (F5)
  - [🆗 ] Sesión se mantiene (no se desloggea)
  - [🆗 ] Nombre de usuario sigue visible en header


- [🆗 ] **Navegación con Sesión**
  - [🆗 ] Navegar a diferentes páginas
  - [🆗 ] Sesión se mantiene en todas
  - [🆗 ] Header siempre muestra usuario loggeado


2.- ERRORES (de testing 7)
1.- La api de wishlist no la detecta, creo que ni siquiera existía.
XHRPOST
http://localhost:3001/api/wishlist
[HTTP/1.1 500 Internal Server Error 688ms]


2.- Tampoco el api de account pedidos 
XHRGET
http://localhost:3001/api/account/pedidos
[HTTP/1.1 500 Internal Server Error 911ms]


3.- También detecto otro error extraño relacionado a la wishtlist creo.
GET
http://localhost:3001/favicon.ico
[HTTP/1.1 404 Not Found 26ms]






2.- NOTAS (de testing 7)
1.- En realidad no existe un desplegable de la opción cuenta en el header (ni tampoco se actualiza dependiendo del nombre de usuario, simplemente aparece “cuenta” y ya. ¿Deberíamos agregar estos cambios? Decidir.


2.- No sabía que se había una pagina de /perfil… sin embargo es imposible acceder a ella al menos que coloques en el propio enlace /perfil al final… además no está actualizada con los datos que propones.


3.- En realidad en el tema de las direcciones, al momento de eliminar la predeterminada, el tag de esta se pasa a la siguiente dirección en caso tengas más de una, y si no igual te deja borrarla.


4.- Todos los apartados de mi perfil (que no está disponible pero entenderás por qué lo menciono), mis pedidos y direcciones están integrados dentro de /account, o sea no te abre una pagina totalmente nueva…. sin embargo en la lista de deseos directamente se va a una pagina totalmente nueva /wishlist. Deberíamos arreglar eso.


## 7. TESTING DE USUARIO REGISTRADO


**⚠️ PRE-REQUISITO: Estar loggeado como `test@vialine.com`**


### 7.1 Acceso al Dashboard


- [🆗] **Menú de Usuario en Header**
  - [❓ ] Click en nombre de usuario en header
  - [❓ ] Dropdown abre con opciones:
    - [❓ ] Mi cuenta
    - [❓ ] Mis pedidos
    - [❓ ] Direcciones
    - [❓ ] Wishlist
    - [❓ ] Cerrar sesión


- [🆗] **Página de Dashboard**
  - [ 🆗] Click en "Mi cuenta"
  - [🆗 ] Redirige a `/account`
  - [🆗 ] URL protegida (middleware verifica sesión)


### 7.2 Dashboard Principal


**URL de prueba:** `http://localhost:3000/account`


- [ 🆗] **Información General**
  - [ ]🆗 Mensaje de bienvenida: "Hola, Test User"
  - [🆗 ] Foto de perfil (avatar o iniciales)
  - [ 🆗] Email visible


- [🆗 ] **Estadísticas de Cuenta**
  - [ 🆗] Card "Pedidos totales" con número
  - [ ✖️] Card "Pedidos pendientes" con número
  - [🆗 ] Card "Productos en wishlist" con número
  - [✖️ ] Card "Direcciones guardadas" con número


- [ 🆗] **Navegación del Dashboard**
  - [🆗 ] Sidebar izquierdo visible con opciones:
    - [❓ ] Resumen (activo)
    - [ 🆗] Mi perfil
    - [🆗 ] Mis pedidos
    - [🆗 ] Direcciones
    - [🆗 ] Wishlist
    - [ 🆗] Cerrar sesión
  - [🆗 ] Opción activa resaltada


- [ ] **Pedidos Recientes**
  - [ ] Sección "Pedidos recientes" visible
  - [ ] Muestra últimos 3 pedidos (si los hay)
  - [ ] Cada pedido muestra:
    - [ ] Número de orden
    - [ ] Fecha
    - [ ] Total
    - [ ] Estado (Pendiente, Procesando, Enviado, Entregado)
    - [ ] Botón "Ver detalles"
  - [🆗 ] Si no hay pedidos: "Aún no has realizado ningún pedido"


### 7.3 Perfil de Usuario


**URL de prueba:** `http://localhost:3000/account/perfil`


- [ ❓] **Formulario de Perfil**
  - [❓ ] Campo "Nombre" (pre-llenado)
  - [❓ ] Campo "Apellido" (pre-llenado)
  - [❓ ] Campo "Email" (pre-llenado, puede ser readonly)
  - [❓ ] Campo "Teléfono" (opcional)
  - [❓ ] Campo "Fecha de nacimiento" (opcional)
  - [❓ ] Botón "Guardar cambios"


- [ ❓] **Actualizar Perfil**
  - [ ❓] Cambiar nombre a: "Test Updated"
  - [ ❓] Cambiar teléfono a: "+51 999 888 777"
  - [❓ ] Click "Guardar cambios"
  - [ ❓] Loading spinner
  - [ ❓] Toast: "Perfil actualizado correctamente"
  - [❓ ] Verificar que cambios se guardaron (refresh página)


- [❓ ] **Sección de Cambio de Contraseña**
  - [❓ ] Campo "Contraseña actual"
  - [❓ ] Campo "Nueva contraseña"
  - [❓ ] Campo "Confirmar nueva contraseña"
  - [ ❓] Botón "Cambiar contraseña"


- [❓ ] **Validaciones de Cambio de Contraseña**
  - [❓ ] Contraseña actual incorrecta
    - [ ❓] Error: "Contraseña actual incorrecta"
  - [❓ ] Nueva contraseña débil
    - [❓ ] Error: "La contraseña debe tener al menos 8 caracteres"
  - [ ❓] Contraseñas no coinciden
    - [❓ ] Error: "Las contraseñas no coinciden"


- [❓ ] **Cambio de Contraseña Exitoso** (⚠️ OPCIONAL)
  - [❓ ] Contraseña actual: `TestVialine2025!`
  - [❓ ] Nueva: `TestVialine2026!`
  - [❓ ] Confirmar: `TestVialine2026!`
  - [ ❓] Click "Cambiar contraseña"
  - [ ❓] Toast: "Contraseña actualizada correctamente"
  - [❓ ] **IMPORTANTE:** Cerrar sesión y volver a loggear con nueva contraseña
  - [❓ ] **AL TERMINAR:** Volver a cambiar a contraseña original


### 7.4 Historial de Pedidos


**URL de prueba:** `http://localhost:3000/account/pedidos`


- [ ] **Lista de Pedidos**
  - [ ] Tabla o cards con todos los pedidos
  - [ ] Ordenados por fecha (más reciente primero)
  - [ ] Cada pedido muestra:
    - [ ] Número de orden (ej: #VIA-2025-0123)
    - [ ] Fecha de compra
    - [ ] Total pagado
    - [ ] Estado con badge de color
    - [ ] Botón "Ver detalles"


- [ ] **Filtros de Pedidos**
  - [ ] Dropdown "Todos los pedidos"
  - [ ] Opciones:
    - [ ] Todos
    - [ ] Pendientes
    - [ ] Procesando
    - [ ] Enviados
    - [ ] Entregados
    - [ ] Cancelados
  - [ ] Click en filtro muestra solo pedidos de ese estado


- [ ] **Pedidos Vacíos**
  - [ ] Si no hay pedidos, mensaje: "No tienes pedidos aún"
  - [ ] Botón "Ir a comprar"


### 7.5 Detalles de Pedido


**⚠️ REQUIERE TENER AL MENOS UN PEDIDO**


- [ ] **Acceso a Detalles**
  - [ ] Click en "Ver detalles" de un pedido
  - [ ] Redirige a `/account/pedidos/[orderId]`
  - [ ] Página carga sin errores


- [ ] **Información del Pedido**
  - [ ] Número de orden destacado
  - [ ] Fecha de compra
  - [ ] Estado actual con badge
  - [ ] Timeline de estados (Pendiente → Procesando → Enviado → Entregado)
  - [ ] Estado actual resaltado en timeline


- [ ] **Productos del Pedido**
  - [ ] Lista de productos comprados
  - [ ] Cada producto muestra:
    - [ ] Imagen
    - [ ] Nombre
    - [ ] Talla y color
    - [ ] Cantidad
    - [ ] Precio unitario
    - [ ] Subtotal


- [ ] **Resumen de Pago**
  - [ ] Subtotal
  - [ ] Descuento (si hubo)
  - [ ] Envío
  - [ ] Total pagado


- [ ] **Información de Envío**
  - [ ] Dirección de envío completa
  - [ ] Nombre del destinatario
  - [ ] Teléfono de contacto
  - [ ] Método de envío
  - [ ] Número de tracking (si está disponible)


- [ ] **Acciones del Pedido**
  - [ ] Botón "Descargar factura" (PDF)
  - [ ] Botón "Volver a comprar" (agrega productos al carrito)
  - [ ] Si es cancelable: Botón "Cancelar pedido"


### 7.6 Direcciones Guardadas


**URL de prueba:** `http://localhost:3000/account/direcciones`


- [🆗 ] **Lista de Direcciones**
  - [🆗 ] Cards o lista de direcciones guardadas
  - [🆗 ] Cada dirección muestra:
    - [🆗 ] Nombre completo del destinatario
    - [🆗 ] Dirección completa
    - [🆗 ] Teléfono
    - [🆗 ] Tag "Principal" si es la predeterminada
    - [🆗 ] Botón "Editar"
    - [ 🆗] Botón "Eliminar"


- [🆗 ] **Agregar Nueva Dirección**
  - [🆗 ] Botón "+ Agregar dirección" visible
  - [🆗 ] Click abre modal o va a nueva página
  - [🆗 ] Formulario con campos:
    - [ 🆗] Nombre completo
    - [✖️ ] DNI
    - [🆗 ] Teléfono
    - [🆗 ] Dirección (calle y número)
    - [🆗 ] Referencia
    - [🆗 ] Distrito
    - [🆗 ] Ciudad
    - [🆗 ] Código postal
    - [ 🆗] Checkbox "Hacer dirección principal"
  - [🆗 ] Botón "Guardar dirección"


- [ 🆗] **Validaciones de Dirección**
  - [🆗 ] Campos vacíos muestran errores
  - [ ✖️] Teléfono inválido muestra error
  - [✖️ ] DNI debe tener 8 dígitos


- [ 🆗] **Guardar Dirección Exitosamente**
  - [ 🆗] Completar todos los campos
  - [ 🆗] Click "Guardar"
  - [🆗 ] Toast: "Dirección guardada correctamente"
  - [ 🆗] Modal se cierra
  - [🆗 ] Nueva dirección aparece en lista


- [ 🆗] **Editar Dirección**
  - [🆗 ] Click en "Editar" de una dirección
  - [🆗 ] Abre formulario con datos pre-llenados
  - [🆗 ] Cambiar campo "Referencia"
  - [🆗 ] Click "Guardar cambios"
  - [🆗 ] Toast: "Dirección actualizada"
  - [🆗 ] Cambios se reflejan en lista


- [🆗 ] **Eliminar Dirección**
  - [🆗 ] Click en "Eliminar" de una dirección NO principal
  - [🆗 ] Modal de confirmación: "¿Estás seguro?"
  - [🆗 ] Click "Sí, eliminar"
  - [🆗 ] Dirección desaparece de lista
  - [🆗 ] Toast: "Dirección eliminada"


- [🆗 ] **Dirección Principal**
  - [ ❓] Intentar eliminar dirección principal
  - [ ❓] Error: "No puedes eliminar tu dirección principal"
  - [ ❓] Marcar otra dirección como principal
  - [❓ ] Tag "Principal" se mueve a la nueva dirección


### 7.7 Wishlist (Favoritos)


**URL de prueba:** `http://localhost:3000/wishlist` o `/account/wishlist`


- [ ] **Página de Wishlist**
  - [ ] Título "Mis Favoritos" o "Wishlist"
  - [ ] Contador: "X productos guardados"


- [ ] **Grid de Productos**
  - [ ] Productos guardados en grid (similar a catálogo)
  - [ ] Cada producto muestra:
    - [ ] Imagen
    - [ ] Nombre
    - [ ] Precio
    - [ ] Botón "Agregar al carrito"
    - [ ] Botón "Eliminar de favoritos" (corazón filled)


- [ ] **Agregar al Carrito desde Wishlist**
  - [ ] Click "Agregar al carrito" en un producto
  - [ ] Si requiere talla: Modal de selección de talla
  - [ ] Seleccionar talla y color
  - [ ] Producto se agrega al carrito
  - [ ] Toast: "Producto agregado al carrito"


- [ ] **Eliminar de Wishlist**
  - [ ] Click en corazón filled
  - [ ] Producto desaparece de wishlist
  - [ ] Contador actualiza (-1)
  - [ ] Toast: "Eliminado de favoritos"


- [ ] **Wishlist Vacía**
  - [ ] Eliminar todos los productos
  - [ ] Mensaje: "Tu wishlist está vacía"
  - [ ] Icono ilustrativo
  - [ ] Botón "Explorar productos"


- [ ] **⚠️ Sincronización con DB (Bloqueador conocido)**
  - [ ] Agregar producto a wishlist
  - [ ] Cerrar sesión
  - [ ] Volver a loggear
  - [ ] Verificar si wishlist se mantiene
  - [ ] **ANOTAR:** Si no se mantiene, confirmar que es el bug conocido (localStorage no sincroniza con DB)


### 7.8 Cerrar Sesión
Notas: No existe la opción de hacer esto en header
- [ ] **Desde Header**
  - [ ] Click en nombre de usuario
  - [ ] Click en "Cerrar sesión"
  - [ ] Modal de confirmación (opcional): "¿Estás seguro?"
  - [ ] Redirige a homepage
  - [] Header vuelve a mostrar "Cuenta" en lugar de nombre
  - [ ] Carrito se mantiene (localStorage)


- [🆗 ] **Desde Dashboard**
  - [🆗 ] En `/account`, click en "Cerrar sesión" en sidebar
  - [ 🆗] Mismo comportamiento que desde header


- [🆗 ] **Intentar Acceder a Rutas Protegidas**
  - [🆗 ] Estando desloggeado, ir a `/account`
  - [🆗 ] Middleware redirige a `/login`
  - [🆗 ] Toast: "Debes iniciar sesión"
  - [🆗 ] Ir a `/checkout`
  - [🆗 ] Middleware redirige a `/login`


2.- ERRORES (de testing 7)
1.- Puse pagar con culqi y saltaron estos problemas o no sé si sean problemas pero tipo aparecen rojos y en advertencia:
✅ Culqi script cargado page.tsx:333:19
📝 Iniciando proceso de checkout... page.tsx:222:15
💾 Guardando orden en base de datos... page.tsx:258:15
[Fast Refresh] rebuilding hot-reloader-client.tsx:371:15
[Fast Refresh] done in 606ms hot-reloader-client.tsx:116:11
✅ Orden creada: VL1761865283184526 page.tsx:273:15
💳 Método Culqi seleccionado, abriendo modal... page.tsx:284:17
🎨 Abriendo modal de Culqi... page.tsx:199:13
La cookie “X-CULQI-SECURE” ha sido rechazada porque se encuentra en un contexto de sitios cruzados y su “SameSite” es “Lax” o “Strict”. v4
La cookie “X-CULQI-SESSIONID” pronto será rechazada porque es externa y no tiene el atributo “Partitioned“. v4
La cookie “X-CULQI-SESSIONID” ha sido rechazada porque se encuentra en un contexto de sitios cruzados y su “SameSite” es “Lax” o “Strict”. v4
La cookie “X-CULQI-SECURE” ha sido rechazada porque se encuentra en un contexto de sitios cruzados y su “SameSite” es “Lax” o “Strict”. index-paB1vfUX.css
La cookie “X-CULQI-SECURE” ha sido rechazada porque se encuentra en un contexto de sitios cruzados y su “SameSite” es “Lax” o “Strict”. index-_QcODZ3b.js
WebGL context was lost. index-_QcODZ3b.js:43:60540
WEBGL_debug_renderer_info is deprecated in Firefox and will be removed. Please use RENDERER. index-_QcODZ3b.js:43:55068
WebGL context was lost. 2 index-_QcODZ3b.js:43:60540
WEBGL_debug_renderer_info is deprecated in Firefox and will be removed. Please use RENDERER. index-_QcODZ3b.js:43:55770
WebGL context was lost. index-_QcODZ3b.js:43:60540
Se ha proporcionado cookie particionada o acceso de almacenamiento a “https://checkout.culqi.com/v4?publicKey=pk_test_pKKKs6UHGrdvfXJr&title=VmlhbGluZQ==&currency=UEVO&description=VmlhbGluZQ==&amount=MTE3MDA=&logo=&installments=ZmFsc2U=&orders=&monto=true&version=4” porque se carga en el contexto de terceros y está activada la partición de estado dinámico.
index-_QcODZ3b.js:77:11576
CULQIENTORNO DE PRUEBASUsted está usando una llave de pruebas(pk_test). Aquí puedes realizar todas las pruebas necesarias para que tu integración sea exitosa. En este entorno no se realizan cargos reales, por lo que te permite probar todas los casos de respuesta en Culqi. Puedes conocer más acerca de este entorno en https://docs.culqi.com/es/documentacion/pagos-online/tarjetas-de-prueba/ <empty string> index-_QcODZ3b.js:62:14461
CULQIDATA LISTENER
Object { checkoutType: "checkout", client: Proxy, options: Proxy, publicKey: "pk_test_pKKKs6UHGrdvfXJr", settings: {…} }
index-_QcODZ3b.js:62:14461


2.- NOTAS (de testing 7)
1.- El checkout está dividido así: información personal, dirección de envío, método de pago y notas adicionales opcional.
Información personal: Nombre, Apellido, Email, Telefono.
Dirección de envio: Dirección, Distrito, Ciudad, CP y Referencia.
Método de Pago: Tarjeta de crédito/débito (culqi), Yape y Pago contra entrega.


Entonces, acá los problemas son graves porque la función de direcciones guardadas no se integra en este checkout, además de que cuando completas dirección en su campo de cuenta te piden algunos datos que no son totales de dirección sabes (como telefono que está en info personal y no en direccion) aunque no sé si sea un problema mayor pero pues no se autorellena nada


Decisión importante: Deberíamos tener la opción activa de pago contra entrega? siento que  debería haber algo tipo que nos asegure de que quizás vaya a pagar o no sé o sea casi ninguna tienda online tiene eso o si? porque tipo confirma la entrega y ya, al menos pagar el 50% o no sé sabes. Decidir por favor.


2.- Como te digo, no existe nada tipo /checkout/payment porque todo está en uno solo
3.- La opción de pago con yape no sirve, anotar eso (en el checkout) pues cuando seleccionas culqi su propio pop up te incluye la opción de tarjeta (que es la que está asociada culqi en nuestro checkout) y yape por defecto o ni idea.


4.- En realidad el sistema de yape ahora es diferente, pues simplemente pones tu numero y apruebas la compra y pues solito culqi detecta si está bien o mal y pues en este caso ya probé con el número 911 111 111 y cualquier código de aprobación y lo aceptó 


5.- Deberíamos revisar el sistema de correos con el de checkout porque siento que está mal estructurado. Anotar como tarea importante pendiente


6.- Insisto en que la estructura y el stack completo, logica y asi,  de los correos tipo cómo se envian y cuando debería ser revisada.




**⚠️ IMPORTANTE: Esto creará órdenes reales en la DB. Usar tarjeta de prueba de Culqi.**


### 8.1 Preparación


- [🆗 ] **Loggear como usuario**
  - [🆗 ] Email: `test@vialine.com`
  - [ 🆗] Contraseña: `TestVialine2025!`


- [ 🆗] **Carrito con Productos**
  - [🆗 ] Agregar 2-3 productos al carrito
  - [🆗 ] Ir a `/carrito`
  - [🆗 ] Verificar que productos están ahí
  - [ 🆗] Click "Proceder al Checkout"


### 8.2 Página de Checkout - Paso 1: Información de Envío


**URL de prueba:** `http://localhost:3000/checkout`


- [🆗 ] **Carga de Página**
  - [🆗 ] Página carga sin errores
  - 🆗[ ] URL es `/checkout` o `/checkout/shipping`
  - [ 🆗] Título "Finalizar compra" visible


- 🆗[ ] **Breadcrumbs o Stepper**
  - [🆗 ] Indicador de pasos visible:
    1. Envío (activo)
    2. Pago
    3. Confirmación
  - [✖️] Paso actual resaltado


- [🆗 ] **Formulario de Envío**
  - [ 🆗] Sección "Información de contacto"
    - [✖️ ] Email (pre-llenado si estás loggeado)
    - [🆗 ] Teléfono
  - [🆗 ] Sección "Dirección de envío"
    - [❓ ] Nombre completo
    - [❓ ] DNI
    - [ ❓] Dirección (calle y número)
    - [❓ ] Referencia
    - [❓ ] Distrito
    - [❓ ] Ciudad/Provincia
    - [❓ ] Código postal
    - [❓ ] Checkbox "Guardar dirección para futuras compras"


- [❓ ] **Direcciones Guardadas (si estás loggeado)**
  - [ ❓] Sección "Direcciones guardadas" visible
  - [ ❓] Lista de direcciones existentes
  - [ ❓] Radio buttons para seleccionar
  - [❓ ] Seleccionar dirección pre-llena el formulario
  - [ ❓] Opción "Usar nueva dirección"


- [🆗 ] **Resumen del Pedido (Sidebar)**
  - [🆗 ] Productos en el pedido visibles
  - [ 🆗] Cada producto muestra:
    - [🆗 ] Imagen thumbnail
    - [🆗 ] Nombre
    - [🆗 ] Talla/Color
    - [ 🆗] Cantidad
    - [ 🆗] Precio
  - [ 🆗] Subtotal
  - [🆗 ] Envío (puede decir "A calcular")
  - [ 🆗] Total estimado


### 8.3 Validaciones del Formulario de Envío


- [🆗 ] **Campos Vacíos**
  - [ 🆗] Dejar todos los campos vacíos
  - [🆗 ] Click "Continuar al pago"
  - [🆗 ] Errores visibles en cada campo requerido
  - [🆗 ] Scroll automático al primer error


- [✖️ ] **DNI Inválido**
  - [✖️ ] DNI: `123` (menos de 8 dígitos)
  - [ ✖️] Error: "DNI debe tener 8 dígitos"


- [🆗 ] **Teléfono Inválido**
  - [ 🆗] Teléfono: `123`
  - [🆗] Error: "Teléfono inválido"


- [🆗 ] **Completar Correctamente**
  - [ 🆗] Usar datos de prueba (ver sección 1.2)
  - [ 🆗] Todos los campos llenos
  - [ 🆗] Click "Continuar al pago"
  - [ 🆗] Avanza a siguiente paso










### 8.4 Página de Checkout - Paso 2: Método de Pago


**URL esperada:** `/checkout/payment`


- [✖️ ] **Carga de Página**
  - [✖️ ] Página carga sin errores
  - [✖️ ] Stepper muestra "Pago" como activo
  - [✖️ ] Botón "Volver" visible


- [✖️ ] **Opciones de Pago**
  - [✖️ ] Sección "Método de pago" visible
  - [✖️ ] Opciones disponibles:
    - [✖️ ] Tarjeta (Culqi)
    - [ ✖️] Yape
    - [ ✖️] Contra Entrega


### 8.5 Pago con Tarjeta (Culqi)


- [ 🆗] **Seleccionar Tarjeta**
  - [ 🆗] Radio button "Tarjeta de crédito/débito" seleccionado
  - [ 🆗] Formulario de Culqi visible
  - [🆗 ] Culqi logo visible


- [🆗 ] **Formulario de Culqi**
  - [🆗 ] Campo "Número de tarjeta"
  - [🆗 ] Campo "Fecha de vencimiento" (MM/AA)
  - [🆗 ] Campo "CVV"
  - [🆗 ] Campo "Email"
  - [🆗 ] Íconos de Visa/Mastercard visibles


- [🆗 ] **Validaciones de Culqi**
  - [ 🆗] Número de tarjeta inválido
    - [ 🆗] Error visual de Culqi
  - [ 🆗] Fecha expirada
    - [🆗 ] Error: "Tarjeta expirada"
  - [🆗 ] CVV inválido
    - [ 🆗] Error visual


- [🆗 ] **Datos de Prueba Culqi**
  - [🆗 ] Número: `4111 1111 1111 1111`
  - [🆗 ] CVV: `123`
  - [🆗 ] Fecha: `12/26`
  - [🆗 ] Email: `test@culqi.com`


- [ ✖️] **Resumen del Pedido Actualizado**
  - [✖️ ] Subtotal (correcto)
  - [✖️ ] Envío: S/10 (o el costo configurado)
  - [✖️ ] Total final
  - [✖️ ] Checkbox "Acepto términos y condiciones"
  - [✖️ ] Botón "Pagar S/XXX.XX"


- [✖️ ] **Procesar Pago**
  - [ ✖️] Marcar checkbox de términos
  - [✖️ ] Click "Pagar S/XXX.XX"
  - [✖️ ] Loading state visible
  - [ 🆗] Mensaje "Procesando pago..."
  - [ ] **IMPORTANTE:** Puede tomar 5-10 segundos


- [🆗 ] **Pago Exitoso**
  - [🆗 ] Redirige a página de confirmación
  - [🆗 ] URL: `/checkout/confirmation` o `/order/[orderId]`
  - [ 🆗] Mensaje de éxito visible
  - [🆗 ] Icono de check verde


### 8.6 Pago con Yape


- [✖️ ] **Seleccionar Yape**
  - [ ✖️] Radio button "Yape" seleccionado
  - [✖️ ] Logo de Yape visible
  - [✖️ ] Instrucciones de pago visibles


- [🆗 ] **Instrucciones de Yape**
  - [🆗 ] Número de Yape de Vialine visible
  - [🆗 ] Monto exacto a pagar
  - [🆗 ] Pasos a seguir:
    1. Abrir app Yape
    2. Yapear a número XXX
    3. Monto exacto: S/XXX
    4. Enviar captura por WhatsApp
  - [✖️ ] Botón de WhatsApp para enviar captura
  - [🆗 ] Checkbox "He realizado el pago"


- [ ✖️] **Confirmar Pago Yape**
  - [✖️ ] Marcar "He realizado el pago"
  - [✖️ ] Marcar "Acepto términos"
  - [✖️ ] Click "Confirmar pedido"
  - [ ✖️] Redirige a confirmación
  - [ ✖️] Mensaje: "Pedido registrado, pendiente de confirmación de pago"


### 8.7 Pago Contra Entrega


- [✖️ ] **Seleccionar Contra Entrega**
  - [✖️ ] Radio button "Contra Entrega" seleccionado
  - [ ✖️] Información visible:
    - [ ✖️] "Paga en efectivo al recibir tu pedido"
    - [ ✖️] "Recargo de S/5" (si aplica)
  - [✖️ ] Total actualiza con recargo


- [✖️ ] **Confirmar Pedido**
  - [ ✖️] Marcar "Acepto términos"
  - [✖️ ] Click "Confirmar pedido"
  - [✖️ ] Redirige a confirmación
  - [✖️ ] Mensaje: "Pedido confirmado, pagarás al recibir"


### 8.8 Página de Confirmación


**URL esperada:** `/order/[orderId]` o `/checkout/confirmation`


- [🆗 ] **Elementos de la Página**
  - [🆗 ] Icono de éxito (check verde)
  - [ 🆗] Título: "¡Pedido confirmado!" o similar
  - [🆗 ] Mensaje de agradecimiento
  - [🆗 ] Número de orden destacado: `#VIA-2025-XXXX`


- [🆗 ] **Detalles del Pedido**
  - [🆗 ] Productos comprados (lista)
  - [ 🆗] Dirección de envío
  - [🆗 ] Método de pago usado
  - [🆗 ] Total pagado
  - [✖️ ] Fecha estimada de entrega


- [✖️ ] **Acciones Disponibles**
  - [✖️ ] Botón "Ver detalles del pedido" → `/account/pedidos/[orderId]`
  - [✖️ ] Botón "Seguir comprando" → `/mujer` o homepage
  - [✖️ ] Botón "Descargar factura" (PDF)


- [🆗 ] **Estado del Carrito**
  - [ 🆗] Carrito se vació automáticamente
  - [ 🆗] Badge del carrito muestra 0
  - [🆗 ] Ir a `/carrito` muestra carrito vacío


### 8.9 Email de Confirmación












**⚠️ VERIFICAR EN INBOX O LOGS**


- [ 🆗] **Email al Cliente**
  - [ 🆗] Revisar inbox de `test@vialine.com`
  - [🆗 ] Email recibido de Vialine
  - [🆗 ] Asunto: "Confirmación de pedido #VIA-2025-XXXX"
  - [🆗 ] Contenido:
    - [🆗 ] Saludo personalizado
    - [🆗 ] Número de orden
    - [ 🆗] Productos comprados
    - [🆗 ] Total pagado
    - [🆗 ] Dirección de envío
    - [✖️ ] Link para ver pedido
    - [ ✖️ ] Información de contacto
  - [✖️  ] Footer de Vialine con logo


- [🆗 ] **Email al Admin**
  - [ 🆗] Revisar logs de Brevo/SendGrid
  - [🆗 ] Email enviado a admin@vialine.com
  - [❓ ] Asunto: "Nuevo pedido #VIA-2025-XXXX"
  - [❓ ] Detalles del pedido para procesar


### 8.10 Verificación en Dashboard


- [ ✖️] **Ver Pedido en Cuenta**
  - [✖️ ] Ir a `/account/pedidos`
  - [✖️ ] Nuevo pedido aparece en lista
  - [ ✖️] Estado: "Pendiente" o "Procesando"
  - [✖️ ] Total correcto
  - [ ✖️] Click "Ver detalles"
  - [✖️ ] Toda la información correcta